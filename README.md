# 🛍️ 깡통시장 이커머스

**깡통시장 이커머스**는 부산 깡통시장의 다양한 빈티지 의류를 온라인에서도 저렴하게 판매할 수 있도록 구축한 이커머스 프로젝트입니다.

## 📌 프로젝트 핵심 목표

### 🚀 **캐싱 최적화**

- Redis 기반 캐싱을 적용하여 실시간 인기 검색어 조회 속도를 개선하고, 자주 요청되는 데이터를 효율적으로 관리하여 서버 부하를 줄였습니다.

### ⚡ **쿼리 최적화**

- 이커머스 프로젝트 특성상 사용자들이 자주 조회하는 기능에 대해 쿼리 최적화를 적용하여 응답 속도를 개선했습니다.

### **🔄 운영 및 배포 효율화**

- CI/CD 파이프라인을 구축하여 코드 변경 사항이 자동으로 테스트 및 배포되도록 설정해 운영의 편의성을 높이고, 배포 자동화를 구현했습니다.

## KEY SUMMARY

### 🚀 성능 개선: 실시간 인기 검색어 목록 조회, Redis 도입으로 약 7배 이상 향상

---

### ✏️ **한줄 요약**

- Redis 도입으로 기존 DB 조회보다 성능이 크게 향상됨
    - **TPS(초당 요청 처리량)**: 약 **732% 증가** (약 7.3배)
    - **평균 요청 처리 시간**: 약 **94.24% 감소** (이전보다 훨씬 빠름)
- 대규모 트래픽 환경에서도 안정적인 서비스 유지 가능

### **🔍 도입 배경**

- 사용자들이 검색하는 키워드를 저장하고, 이를 기반으로 인기 검색어 순위를 제공하는 기능을 구현하고자 함
- 기존 방식(데이터베이스에서 직접 조회)에서는 검색어 데이터를 매번 DB에서 조회해야 하므로 성능 저하가 발생
- Redis를 활용하여 인기 검색어를 저장 및 조회하면 훨씬 빠를 것이라 판단

### **🛠 기술적 선택지**

- 기존 DB 조회 방식
    - 장점: 데이터 일관성 유지가 용이함
    - 단점: 실시간 트래픽이 많을 경우 부하가 커지고 응답 속도가 느려짐
- Redis 기반 캐싱 방식 (채택)
    - 장점: 검색어 데이터를 빠르게 조회할 수 있으며, DB 부하를 줄여 성능 최적화 가능
    - 단점: 추가적인 캐싱 전략이 필요

### 🚀 성능 개선: 가격 범위 별 상품 조회, 쿼리 최적화로 약 2배 향상

---

### ✏️ 한줄 요약

- B+Tree 인덱스 적용으로 가격 범위 검색 성능 최적화, Slice 객체 활용으로 페이징 효율 개선

### **🛠** 기술적 선택지

- 기존 QueryDSL 방식
    - **Full Scan 발생**: 조건 검색 시 **모든 데이터를 탐색**하여 성능 저하
    - **Count 연산 부담**: 검색 조건에 맞는 데이터 개수를 항상 계산해야 하므로 **대량 데이터 처리 시 성능 저하 발생**
- 최적화 (B+Tree Index + Slice 페이징 적용)
    - **B+Tree 인덱스 적용**
        - **트리 구조 기반의 정렬된 데이터 검색**으로 **불필요한 노드 탐색 감소**
        - 가격 범위 검색 시 **빠른 탐색 가능**
    - **Slice 객체 기반 페이징 적용**
        - 조건에 맞는 데이터가 많을 경우 **count 연산을 수행하지 않아 성능 저하 방지**
        - **이전 페이지 정보만 유지하면서 다음 페이지 탐색 가능**, 페이징 비용 절감

### 🚀 서버 배포: AWS를 활용한 서버 배포와 Github Actions CI/CD 구축

---

### **✏️ 한줄 요약**

- 안정적인 배포를 위해 자동 빌드 및 테스트, AWS 서버 배포까지 한 번에 처리될 수 있도록 시스템을 구축

### **🛠 기술적 선택지**

- 수동 배포 (기존 방식)
    - 빌드, 업로드, 배포 등 작업을 수동으로 진행
    - 배포 속도가 느리고, 배포 후 수동 확인 필요
    - 배포 담당자가 필요하여 협업 효율성이 낮음
- CI/CD 구축 (개선 방식)
    - 자동화된 배포 파이프라인 구축

      ### 📌 CI (Continuous Integration, 지속적 통합)

        1. `develop` 및 `master` 브랜치에 `pull request`이벤트가 발생하면 자동으로 테스트를 실행
            - 테스트 성공 시 →  자동으로 `merge`를 수행 (Github Settings)
            - 테스트 실패 시 → 수동으로도 `merge`할 수 없도록 제한 (Github Settings)
        2. `develop` 브랜치와 `master` 브랜치에 `push`가 발생하면 자동으로 테스트를 실행
        3. 테스트 결과를 `PR` 코멘트로 출력

      ### 📌 CD (Continuous Deployment, 지속적 배포)

        1. `master` 브랜치에서 빌드된 결과물을 자동 배포
            - `jar` 파일을 생성하여 `AWS Elastic Beanstalk`에 배포
        2. GitHub Actions 플랫폼 이용
            - GitHub와 완벽하게 통합되어 간편한 설정 가능
            - 확장성 뛰어나 다양한 배포 환경 지원
        3. 코드 변경마다 빌드, 테스트, 배포 등의 작업을 자동으로 실행
            - 협업 효율성 대폭 증가

### 🛠️ 트러블 슈팅: **SQLSyntaxErrorException**

---

### 🔍 배경

- Soft Delete 적용을 위해 @Where 어노테이션을 사용하여 is_deleted = false인 데이터만 조회하도록 설정
- @SQLDelete 어노테이션을 활용하여 삭제 요청 시 실제 데이터 삭제 대신 Soft Delete 처리되도록 SQL 쿼리를 구성

### ⚠️ 문제 발생

- SQL 실행 중 **SQLSyntaxErrorException 발생**
- 원인 분석 결과:
    - 실제 테이블 컬럼명: id
    - 잘못된 SQL 구문에서 사용한 컬럼명: member_id
    - member_id 컬럼이 존재하지 않아 SQL 구문 오류 발생

### 🎯 해결 방안

- 잘못된 컬럼명 **member_id**를 실제 테이블 컬럼명 **id**로 수정하여 정상적으로 Soft Delete가 동작하도록 수정

### 🛠️ 트러블 슈팅: AWS 서버 502 Bad Gateway

---

### 🔍 배경

- 프로젝트 초기에 AWS Elastic Beanstalk 환경에서 애플리케이션을 수동 배포하고, Postman으로 API 테스트 진행

### ⚠️ 문제 발생

- API 요청 시 `502 Bad Gateway` 응답 발생
- 원인 분석 결과:
    - 서버 간의 통신 과정에서 유효하지 않은 응답이 반환됨
    - Elastic Beanstalk의 기본 설정에서 애플리케이션은 포트 `5000`에서 실행됨
    - Elastic Beanstalk의 기본 환경에서는 NginX가 Reverse Proxy로 사용, 내부에서 실행되는 애플리케이션과 프록시 역할을 수행하여 요청을 포트 `5000`으로 전달해야 함

### 🎯 해결 방안

- Elastic Beanstalk 애플리케이션 환경 속성에서 `SERVER_PORT` 의 값을 5000으로 설정
- NginX와 내부 애플리케이션 간의 포트 일치를 보장하여 정상적으로 요청을 전달할 수 있도록 수정

## 🏗️ 인프라 아키텍처 & 적용 기술

`CI/CD` : GitHub Actions를 활용하여 자동 빌드 및 배포 파이프라인 구축

`AWS Elastic Beanstalk` : 클라우드 환경에서 애플리케이션을 배포 및 운영

`Redis` : 검색어 캐싱 및 성능 최적화를 위한 인메모리 데이터베이스 활용

`github Actions` : CI/CD 자동화 워크플로우 구성

`RDS` : AWS RDS를 이용하여 서버 데이터베이스 관리 및 운영 안정성 확보

`MySQL` : 관계형 데이터베이스로 트랜잭션 및 데이터 일관성 유지

## **⚙** 주요 기능

### **🔍 인기 검색어 조회: Redis 캐싱 활용**

---

- Redis 캐싱을 적용하여 인기 검색어 조회 기능 제공
- 기존 DB 조회 방식보다 빠르게 인기 검색어 목록을 반환하여 성능 최적화
- 트래픽 증가 시에도 안정적인 검색어 조회 가능

### **🔍** 가격 범위 별 상품 조회: 쿼리 최적화

---

- **B+Tree Index**와 **QueryDSL**을 활용하여 **가격 범위 검색 성능 최적화**
- **Slice 기반 페이징 적용**으로 **불필요한 데이터 로딩 방지 및 성능 개선**
- **빠른 가격별 상품 검색 가능**, 트래픽 증가 시에도 원활한 조회 성능 유지

## 역할 분담 및 협업 방식

### 팀 구성 및 담당 업무

---

- 이승찬(팀장)
    - **회원 관리**: 회원 CRUD 기능 개발
    - **AOP 기반 권한 체크** 적용
    - **Redis 캐싱 적용 및 성능 최적화**
- 고수연(팀원)
    - **상품 좋아요 기능 구현**
    - **AWS 인프라 구축 및 CI/CD 파이프라인 설정**
- 이수진(팀원)
    - **주문 관리**: 주문 CRUD 기능 개발
    - **테스트 코드 작성**
    - **쿼리 최적화 적용으로 성능 개선**
- 황서호(팀원, 발표)
    - **가게 및 상품 관리**: 가게, 상품 CRUD 기능 개발
    - **테스트 코드 작성**
    - **Redis 캐싱 적용 및 성능 최적화 지원**

### 🛠 **협업 방식**

---

- 정기적인 미팅으로 진행 상황 공유 및 문제 해결
- 팀 슬랙을 통해 진행 상황 공유
